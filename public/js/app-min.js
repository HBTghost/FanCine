"use strict";var modal=document.getElementById("modal"),parser=new DOMParser,redirectURL="",forceLogin=!1;function popdownModal(){modal.style.display="none",fetch("/isLogin").then(function(e){e.text().then(function(e){forceLogin&&"false"===e&&(window.location="/")})})}function popupModal(){modal.style.display="block"}function renderUsernameToggle(){fetch("/render/header").then(function(e){e.text().then(function(e){var n=parser.parseFromString(e,"text/html");document.querySelector("#usernameToggle").innerHTML=n.querySelector("#usernameToggle").innerHTML})})}function login(e){e.preventDefault(),fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:document.querySelector("#emailLogin").value,password:document.querySelector("#passwordLogin").value})}).then(function(){redirectURL.length>0&&(window.location=redirectURL,redirectURL=""),popdownModal(),renderUsernameToggle()})}function logout(e){e.preventDefault(),fetch("/logout").then(function(){renderUsernameToggle(),fetch("#").then(function(e){e.text().then(function(e){console.log(e),"false"===e&&(popupModal(),forceLogin=!0)})})})}function forceLoginAndRedirect(e){redirectURL=e,fetch("/isLogin").then(function(n){n.text().then(function(n){"false"===n?popupModal():window.location=e})})}window.onclick=function(e){e.target===modal&&popdownModal()};