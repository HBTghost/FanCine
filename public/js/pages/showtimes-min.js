"use strict";var moviesData,theatersData,showtimesData,movieItems,theaterItems,colorWhite="#fff",colorLightgray="#f1f1f1",colorDarkgray="#a0a3a7",colorBlack="#000",colorOrange="#f26b38",parser=new DOMParser,movieTabBtn=document.getElementById("showtimes-controller-movie"),theaterTabBtn=document.getElementById("showtimes-controller-theater"),mainContainer=document.getElementById("showtimes-main"),moviesCol=document.getElementById("showtimes-col-movie"),theatersCol=document.getElementById("showtimes-col-theater"),showtimesCol=document.getElementById("showtimes-col-showtime"),moviesList=document.querySelector("#showtimes-col-movie .showtimes-row-list"),theatersList=document.querySelector("#showtimes-col-theater .showtimes-row-list"),showtimesList=document.querySelector("#showtimes-col-showtime .showtimes-row-list"),moviesListNoti=moviesList.firstElementChild,theatersListNoti=theatersList.firstElementChild,showtimesListNotiTheater=showtimesList.firstElementChild,showtimesListNotiMovie=showtimesList.lastElementChild,curMovieItemIndex=0,curMovieID="",curTheaterItemIndex=0,curTheaterID="",curTheaterMovieID="",curTab=0,spinnerModal=document.getElementsByClassName("spinner-modal")[0];function enableSpinner(){spinnerModal.style.display="block"}function disableSpinner(){spinnerModal.style.display="none"}function addClickEventToTheaterItems(e){theaterItems=document.getElementsByClassName("showtimes-row-data-theater");for(var t=function(t){theaterItems[t].addEventListener("click",function(){e(t)})},o=0;o<theaterItems.length;++o)t(o);if(0===curTab)for(var i=0;i<theaterItems.length;++i)theaterItems[i].parentElement.setAttribute("href","#showtimes-col-theater");else for(var s=0;s<theaterItems.length;++s)theaterItems[s].parentElement.setAttribute("href","#showtimes-col-showtime")}function addClickEventToMovieItems(e){movieItems=document.getElementsByClassName("showtimes-row-data-movie");for(var t=function(t){movieItems[t].addEventListener("click",function(){e(t)})},o=0;o<movieItems.length;++o)t(o);if(0===curTab)for(var i=0;i<movieItems.length;++i)movieItems[i].parentElement.setAttribute("href","#showtimes-col-theater");else for(var s=0;s<movieItems.length;++s)movieItems[s].parentElement.setAttribute("href","#showtimes-col-movie")}function loadSampleShowtimes(e){enableSpinner(),fetch("/showtimes/sampleData").then(function(t){t.text().then(function(t){showtimesData=parser.parseFromString(t,"text/html"),showtimesList.innerHTML=e%2==0?showtimesData.getElementById("showtimes-showtimes-1").innerHTML:showtimesData.getElementById("showtimes-showtimes-2").innerHTML,disableSpinner()})})}function clickMovieItemAtTheaterTab(e){movieItems[curMovieItemIndex].style.backgroundColor=colorWhite,movieItems[e].style.backgroundColor=colorLightgray,curMovieItemIndex=e,curMovieID=movieItems[e].firstElementChild.innerHTML,loadSampleShowtimes(e)}function loadMoviesByTheaterID(e){enableSpinner(),fetch("/showtimes/allMovies/".concat(e)).then(function(e){e.text().then(function(e){moviesData=parser.parseFromString(e,"text/html"),moviesList.innerHTML=moviesData.getElementById("showtimes-movies").innerHTML,showtimesList.innerHTML="",showtimesList.appendChild(showtimesListNotiMovie),addClickEventToMovieItems(clickMovieItemAtTheaterTab),disableSpinner()})})}function clickTheaterItemAtTheaterTab(e){theaterItems[curTheaterItemIndex].style.backgroundColor=colorWhite,theaterItems[e].style.backgroundColor=colorLightgray,curTheaterItemIndex=e,curTheaterID=theaterItems[e].firstElementChild.innerHTML,curMovieItemIndex=0,loadMoviesByTheaterID(curTheaterID)}function loadAllTheaters(){enableSpinner(),fetch("/showtimes/allTheaters").then(function(e){e.text().then(function(e){theatersData=parser.parseFromString(e,"text/html"),mainContainer.innerHTML="",mainContainer.appendChild(theatersCol),mainContainer.appendChild(moviesCol),mainContainer.appendChild(showtimesCol),theatersList.innerHTML=theatersData.getElementById("showtimes-theaters").innerHTML,moviesList.innerHTML="",moviesList.appendChild(moviesListNoti),showtimesList.innerHTML="",showtimesList.appendChild(showtimesListNotiMovie),addClickEventToTheaterItems(clickTheaterItemAtTheaterTab),disableSpinner()})})}function loadShowtimesByTheaterMovieID(e){enableSpinner(),fetch("/showtimes/allShowtimes/".concat(e)).then(function(e){e.text().then(function(e){showtimesData=parser.parseFromString(e,"text/html"),showtimesList.innerHTML=showtimesData.getElementById("showtimes-showtimes").innerHTML,disableSpinner()})})}function clickTheaterItemAtMovieTab(e){theaterItems[curTheaterItemIndex].style.backgroundColor=colorWhite,theaterItems[e].style.backgroundColor=colorLightgray,curTheaterItemIndex=e,loadShowtimesByTheaterMovieID(curTheaterMovieID=theaterItems[e].firstElementChild.innerHTML)}function loadTheatersByMovieID(e){enableSpinner(),fetch("/showtimes/allTheaters/".concat(e)).then(function(e){e.text().then(function(e){theatersData=parser.parseFromString(e,"text/html"),theatersList.innerHTML=theatersData.getElementById("showtimes-theaters").innerHTML,showtimesList.innerHTML="",showtimesList.appendChild(showtimesListNotiTheater),addClickEventToTheaterItems(clickTheaterItemAtMovieTab),disableSpinner()})})}function clickMovieItemAtMovieTab(e){movieItems[curMovieItemIndex].style.backgroundColor=colorWhite,movieItems[e].style.backgroundColor=colorLightgray,curMovieItemIndex=e,curMovieID=movieItems[e].firstElementChild.innerHTML,curTheaterItemIndex=0,loadTheatersByMovieID(curMovieID)}function loadAllMovies(){enableSpinner(),fetch("/showtimes/allMovies").then(function(e){e.text().then(function(e){moviesData=parser.parseFromString(e,"text/html"),mainContainer.innerHTML="",mainContainer.appendChild(moviesCol),mainContainer.appendChild(theatersCol),mainContainer.appendChild(showtimesCol),moviesList.innerHTML=moviesData.getElementById("showtimes-movies").innerHTML,theatersList.innerHTML="",theatersList.appendChild(theatersListNoti),showtimesList.innerHTML="",showtimesList.appendChild(showtimesListNotiTheater),addClickEventToMovieItems(clickMovieItemAtMovieTab),disableSpinner()})})}function main(){var e=document.querySelector(".sticky-top").offsetHeight,t="-".concat(e,"px"),o="".concat(e,"px");document.querySelector("#showtimes-col-theater").style.marginTop=t,document.querySelector("#showtimes-col-theater").style.paddingTop=o,document.querySelector("#showtimes-col-movie").style.marginTop=t,document.querySelector("#showtimes-col-movie").style.paddingTop=o,document.querySelector("#showtimes-col-showtime").style.marginTop=t,document.querySelector("#showtimes-col-showtime").style.paddingTop=o,loadAllMovies()}theaterTabBtn.addEventListener("click",function(){curTab=1,movieTabBtn.style.borderBottomColor="transparent",movieTabBtn.style.color=colorDarkgray,theaterTabBtn.style.borderBottomColor=colorOrange,theaterTabBtn.style.color=colorBlack,loadAllTheaters()}),movieTabBtn.addEventListener("click",function(){curTab=0,theaterTabBtn.style.borderBottomColor="transparent",theaterTabBtn.style.color=colorDarkgray,movieTabBtn.style.borderBottomColor=colorOrange,movieTabBtn.style.color=colorBlack,loadAllMovies()}),main();