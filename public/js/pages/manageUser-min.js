"use strict";var preColIndex,preSortType,userRowElements=document.querySelectorAll("#mnuser-table tbody tr"),tableRowElements=document.querySelectorAll("#mnuser-table tr"),tableBodyElement=document.querySelector("#mnuser-table tbody"),displayCheckboxElements=document.querySelectorAll("#mnuser-display .mmnuser-display-item input"),sortingIconsElements=document.querySelectorAll(".mnuser-cell-sort"),COL=Object.freeze({ROLE:0,NAME:1,EMAIL:2,PHONE_NUM:3,DOB:4,GENDER:5,ADDRESS:6,CITY:7,AREA:8,STAR:9,EXPENSE:10,ID:11}),parser=new DOMParser;function removeUserFromDatabase(e){var n=e.firstElementChild.innerHTML;try{fetch("/api/users/".concat(n),{method:"DELETE"}).then(function(n){n.json().then(function(n){n.message?Swal.fire({icon:"error",title:"Oops...",html:n.message}):(e.classList.add("fall"),e.ontransitionend=function(n){return e.remove()},Swal.fire({icon:"success",title:"Thành công",html:"Xóa user thành công"}))})})}catch(e){return!1}}function removeUser(e){var n=e.target,t=n.parentElement;"trash-btn"===n.classList[0]?Swal.fire({title:"Cảnh báo",icon:"warning",html:"Bạn có chắc chắn xóa user <b>".concat(t.innerText,"</b> không?"),confirmButtonColor:"#E74C3C",confirmButtonText:"Chắc chắn",showCancelButton:!0,cancelButtonColor:"#99A3A4",cancelButtonText:"Không"}).then(function(e){e.isConfirmed&&removeUserFromDatabase(t)}):"edit-btn"===n.classList[0]?t.classList.toggle("completed"):"complete-btn"===n.classList[0]&&t.classList.toggle("completed")}function showTableColumn(e){tableRowElements.forEach(function(n){n.children[e].style.display="table-cell"})}function hideTableColumn(e){tableRowElements.forEach(function(n){n.children[e].style.display="none"})}function formatExpenseValues(){userRowElements.forEach(function(e){e.children[COL.EXPENSE].innerHTML=parseInt(e.children[COL.EXPENSE].innerHTML,10).toLocaleString("it-IT",{style:"currency",currency:"VND"})})}function refresh(){userRowElements=document.querySelectorAll("#mnuser-table tbody tr"),tableRowElements=document.querySelectorAll("#mnuser-table tr"),formatExpenseValues(),displayCheckboxElements.forEach(function(e,n){!1===e.checked&&hideTableColumn(n)})}function sortAllUsers(e,n){fetch("/admin/manageUser/sort/".concat(e,"/").concat(n)).then(function(e){e.text().then(function(e){var n=parser.parseFromString(e,"text/html");console.log(n),tableBodyElement.innerHTML=n.getElementById("mnuser-users").innerHTML,refresh()})})}function initTable(){preColIndex=COL.ROLE,preSortType=0,sortingIconsElements[preColIndex].children[preSortType].classList.add("mnuser-cell-sort-asc-selected"),sortAllUsers(preColIndex,preSortType)}function eventDisplayCheckboxes(){displayCheckboxElements.forEach(function(e,n){e.addEventListener("click",function(){!0===e.checked?showTableColumn(n):hideTableColumn(n)})})}function eventSorting(){var e=["asc","desc"],n=0;sortingIconsElements.forEach(function(t,r){for(var l=function(l){t.children[l].addEventListener("click",function(){t.children[l].classList.add("mnuser-cell-sort-".concat(e[l],"-selected")),sortingIconsElements[preColIndex].children[preSortType].classList.remove("mnuser-cell-sort-".concat(e[preSortType],"-selected")),preColIndex===r&&preSortType===l?(n+=1)%2==0?(t.children[l].classList.add("mnuser-cell-sort-".concat(e[l],"-selected")),sortAllUsers(r,l)):sortAllUsers(-1,0):(n=0,sortAllUsers(r,l)),preColIndex=r,preSortType=l}),t.children[l].addEventListener("mouseenter",function(){t.children[l].classList.add("mnuser-cell-sort-".concat(e[l],"-hover"))}),t.children[l].addEventListener("mouseleave",function(){t.children[l].classList.remove("mnuser-cell-sort-".concat(e[l],"-hover"))})},s=0;s<t.children.length;++s)l(s)})}function handleEvents(){eventDisplayCheckboxes(),eventSorting()}function main(){initTable(),refresh(),handleEvents()}main();